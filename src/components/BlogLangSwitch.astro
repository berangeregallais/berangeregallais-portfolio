---
import { getCollection, type CollectionEntry } from "astro:content";

interface Props {
  post: CollectionEntry<'blog'>;
  currentLang: "fr" | "en";
}

const { post, currentLang } = Astro.props;

// On cherche la langue opposÃ©e
const targetLang = currentLang === "fr" ? "en" : "fr";

let langSwitchHref = `/${targetLang}/blog/`;

if (post.data.translationKey) {
  const match = (await getCollection("blog", ({ data }) =>
    data.language === targetLang &&
    data.draft !== true &&
    data.translationKey === post.data.translationKey
  ))[0];

  if (match) {
    langSwitchHref = `/${targetLang}/blog/${match.slug}/`;
  }
}
---

<a href={langSwitchHref} class="inline-flex items-center gap-2 text-sm px-3 py-2 border rounded-lg hover:shadow">
  {currentLang === "fr" ? "ğŸ‡¬ğŸ‡§ Read in English" : "ğŸ‡«ğŸ‡· Lire en franÃ§ais"}
</a>
