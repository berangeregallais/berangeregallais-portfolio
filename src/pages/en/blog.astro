---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";

const allPosts = await getCollection(
    "blog",
    ({ data }) => data.language === "en" && data.draft !== true,
);
const posts = allPosts.sort(
    (a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime(),
);
---

<BaseLayout
    title="Blog â€” EN"
    description="Articles about API documentation, AI, and documentation strategy."
>
    <div class="blog-container">
        <h1 class="text-3xl font-bold">Blog</h1>
        <div class="blog-divider"></div>

        {
            posts.length === 0 ? (
                <p>No posts yet.</p>
            ) : (
                <ul class="blog-grid">
                    {posts.map((post) => (
                        <li>
                            <a
                                href={`/en/blog/${post.slug}/`}
                                class="blog-card"
                            >
                                <h2>{post.data.title}</h2>
                                <p class="card-desc">{post.data.description}</p>
                                <div class="card-foot">
                                    <span>
                                        {post.data.publishDate.toLocaleDateString(
                                            "en-GB",
                                        )}
                                    </span>
                                    {post.data.tags?.length ? (
                                        <span>#{post.data.tags[0]}</span>
                                    ) : (
                                        <span>&nbsp;</span>
                                    )}
                                </div>
                            </a>
                        </li>
                    ))}
                </ul>
            )
        }
    </div>
</BaseLayout>
