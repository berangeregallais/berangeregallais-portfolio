---
// src/pages/en/portfolio.astro
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import PortfolioCard from "../../components/PortfolioCard.astro";

// Get portfolio projects for English
const allProjects = await getCollection("portfolio", ({ data }) => {
  return data.language === "en";
});

// Sort by project date (most recent first)
const projects = allProjects.sort(
  (a, b) => b.data.projectDate.getTime() - a.data.projectDate.getTime(),
);

// Get all unique categories for display
const allCategories = [
  ...new Set(projects.flatMap((project) => project.data.category)),
];
---

<BaseLayout
  title="Portfolio | Technical Documentation Projects & Case Studies"
  description="Examples of my work in technical documentation: APIs, developer portals, AI compliance frameworks, and documentation strategy."
  lang="en"
>
  <!-- Hero Section -->
  <section class="portfolio-hero">
    <div class="container">
      <div class="hero-content">
        <h1>Portfolio</h1>
        <p class="hero-subtitle">
          Explore a selection of my projects in API documentation, AI, and
          documentation strategy.
        </p>
      </div>
    </div>
  </section>

  <!-- Projects Grid -->
  <section class="portfolio-projects">
    <div class="container">
      <h2 class="section-title">Projects</h2>
      <div class="projects-grid">
        {
          projects.map((project, index) => (
            <div
              class="project-wrapper"
              style={`animation-delay: ${index * 0.1}s`}
            >
              <PortfolioCard
                title={project.data.title}
                client={project.data.client}
                description={project.data.description}
                tags={project.data.technologies}
                image={project.data.image}
                link={project.data.demoUrl!}
                category={project.data.category}
              />
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="portfolio-cta">
    <div class="container">
      <div class="cta-content">
        <h2>Need clear, effective documentation?</h2>
        <p>
          I help you structure, write, and maintain your documentation so it’s
          useful to developers, compliant with requirements, and easy to evolve.
        </p>
        <div class="cta-benefits">
          <div class="benefit">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
              <path d="M20 6 9 17l-5-5"></path>
            </svg>
            Needs assessment
          </div>
          <div class="benefit">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
              <path d="M20 6 9 17l-5-5"></path>
            </svg>
            Tailored documentation strategy
          </div>
          <div class="benefit">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
              <path d="M20 6 9 17l-5-5"></path>
            </svg>
            Practical solutions implementation
          </div>
        </div>
        <div class="cta-buttons">
          <a href="/en/contact" class="btn btn-primary btn-large">
            <span>Let’s discuss your project</span>
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
              <path d="M5 12h14m-7-7 7 7-7 7"></path>
            </svg>
          </a>
          <a href="/en/services" class="btn btn-secondary">
            View Services
          </a>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  /* ===============================
   PORTFOLIO HERO
   =============================== */
  .portfolio-hero {
    padding: 8rem 0 5rem;
    background: linear-gradient(
      135deg,
      rgb(var(--color-background)) 0%,
      rgb(var(--color-primary) / 0.05) 50%,
      rgb(var(--color-accent) / 0.03) 100%
    );
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .portfolio-hero::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
      ellipse at center top,
      rgb(var(--color-primary) / 0.05) 0%,
      transparent 70%
    );
    pointer-events: none;
  }

  .hero-content {
    position: relative;
    z-index: 1;
    max-width: 900px;
    margin: 0 auto;
  }

  .portfolio-hero h1 {
    font-family: var(--font-serif);
    font-size: clamp(3rem, 6vw, 5rem);
    font-weight: 700;
    margin-bottom: 2rem;
    color: rgb(var(--color-text));
    letter-spacing: -0.02em;
  }

  .hero-subtitle {
    font-size: 1.375rem;
    color: rgb(var(--color-text-muted));
    margin: 0 auto 4rem;
    line-height: 1.7;
    font-weight: 400;
    max-width: 800px;
  }

  /* ===============================
   PROJECTS SECTION
   =============================== */
  .portfolio-projects {
    padding: 8rem 0;
    background: rgb(var(--color-background));
  }

  .section-title {
    font-family: var(--font-serif);
    font-size: 3rem;
    text-align: center;
    margin-bottom: 4rem;
    color: rgb(var(--color-text));
    position: relative;
  }

  .section-title::after {
    content: "";
    position: absolute;
    bottom: -1rem;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 3px;
    background: linear-gradient(
      90deg,
      rgb(var(--color-primary)),
      rgb(var(--color-accent))
    );
    border-radius: 2px;
  }

  .projects-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 3rem;
  }

  .project-wrapper {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.8s ease-out forwards;
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* ===============================
   CTA SECTION
   =============================== */
  .portfolio-cta {
    padding: 8rem 0;
    background: linear-gradient(
      135deg,
      rgb(var(--color-primary) / 0.08) 0%,
      rgb(var(--color-accent) / 0.05) 100%
    );
    text-align: center;
    position: relative;
  }

  .portfolio-cta::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
      ellipse at center,
      rgb(var(--color-primary) / 0.03) 0%,
      transparent 70%
    );
  }

  .cta-content {
    position: relative;
    z-index: 1;
    max-width: 800px;
    margin: 0 auto;
  }

  .portfolio-cta h2 {
    font-family: var(--font-serif);
    font-size: 3rem;
    margin-bottom: 1.5rem;
    color: rgb(var(--color-text));
  }

  .portfolio-cta p {
    font-size: 1.25rem;
    color: rgb(var(--color-text-muted));
    margin-bottom: 3rem;
    line-height: 1.7;
  }

  .cta-benefits {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 3rem;
    flex-wrap: wrap;
  }

  .benefit {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    color: rgb(var(--color-text-muted));
  }

  .benefit svg {
    color: rgb(var(--color-primary));
  }

  .cta-buttons {
    display: flex;
    gap: 2rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  /* ===============================
   BUTTONS
   =============================== */
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 2rem;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    transition: all var(--transition-normal);
    border: 2px solid transparent;
  }

  :root[data-theme="light"] .btn-primary {
    color: #d0d0d0;
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 24px rgb(var(--color-primary) / 0.3);
  }

  .btn-secondary {
    background: transparent;
    color: rgb(var(--color-text));
    border-color: rgb(var(--color-border));
  }

  .btn-secondary:hover {
    background: rgb(var(--color-surface));
    transform: translateY(-2px);
  }

  .btn-large {
    padding: 1.25rem 2.5rem;
    font-size: 1.1rem;
  }

  /* ===============================
   RESPONSIVE
   =============================== */
  @media (max-width: 768px) {
    .portfolio-hero {
      padding: 6rem 0 4rem;
    }

    .hero-subtitle {
      font-size: 1.125rem;
    }

    .portfolio-stats {
      gap: 2.5rem;
      flex-wrap: wrap;
    }

    .projects-grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .cta-benefits {
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .cta-buttons {
      flex-direction: column;
      align-items: center;
    }

    .section-title,
    .portfolio-cta h2 {
      font-size: 2.25rem;
    }
  }

  @media (max-width: 480px) {
    .projects-grid {
      grid-template-columns: 1fr;
    }
  }

  /* ===============================
   Portfolio Page Adjustments
   =============================== */

  /* Réduction des espacements entre sections */
  .portfolio-hero {
    padding: 4rem 0 3rem; /* avant : souvent 6rem ou + */
  }
  .portfolio-projects {
    padding: 4rem 0; /* réduit l’air entre les projets */
  }
  .portfolio-cta {
    padding: 4rem 0; /* resserre la zone CTA */
  }

  /* Ajustement du titre/intro */
  .portfolio-hero .hero-subtitle {
    margin-top: 0.75rem;
    margin-bottom: 0; /* réduit l’espace avant la section suivante */
  }

  /* Empêche les boutons CTA de s’étirer en largeur sur mobile */
  @media (max-width: 768px) {
    .cta-buttons .btn {
      display: inline-flex !important;
      width: auto !important;
      max-width: 100%;
      flex: 0 0 auto; /* empêche l’étirement */
      align-self: center; /* centre le bouton */
    }

    .cta-buttons {
      flex-direction: column; /* empile les boutons si nécessaire */
      align-items: center;
      gap: 1rem;
    }
  }
</style>
