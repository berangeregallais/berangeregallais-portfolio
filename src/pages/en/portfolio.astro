---
// src/pages/en/portfolio.astro
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import PortfolioCard from "../../components/PortfolioCard.astro";

// Get portfolio projects for English
const allProjects = await getCollection("portfolio", ({ data }) => {
  return data.language === "en";
});

// Sort by project date (most recent first)
const projects = allProjects.sort(
  (a, b) => b.data.projectDate.getTime() - a.data.projectDate.getTime(),
);

// Get all unique categories for display
const allCategories = [
  ...new Set(projects.flatMap((project) => project.data.category)),
];
---

<BaseLayout
  title="Portfolio | Conversational AI Agents & Technical Documentation"
  description="Examples of my projects: conversational AI agents, API documentation and intelligent solutions for businesses."
  lang="en"
>
  <!-- Hero Section -->
  <section class="portfolio-hero">
    <div class="container">
      <div class="hero-content">
        <h1>Portfolio</h1>
        <p class="hero-subtitle">
          Conversational AI agents and technical documentation projects
        </p>
      </div>
    </div>
  </section>

  <!-- Featured Video Demo -->
  <section class="featured-demo">
    <div class="container">
      <div class="demo-header">
        <span class="demo-badge">‚ú® Featured Project</span>
        <h2>Neolens RAG Agent in Action</h2>
        <p>
          Discover how this conversational agent answers technical questions 
          with source citations, multilingual support, and zero hallucination.
        </p>
      </div>
      
      <div class="demo-grid">
        <div class="demo-video">
          <video controls preload="metadata" poster="/portfolio/01-home-welcome.png">
            <source src="/portfolio/videos/02-source-citation-demo.mp4" type="video/mp4">
            Your browser does not support video playback.
          </video>
        </div>
        
        <div class="demo-features">
          <h3>Key Features</h3>
          <ul>
            <li>
              <div class="feature-icon">üéØ</div>
              <div class="feature-content">
                <strong>Intelligent RAG</strong>
                <span>FAISS vector search in 34 documents (50k words)</span>
              </div>
            </li>
            <li>
              <div class="feature-icon">üìö</div>
              <div class="feature-content">
                <strong>Source Citations</strong>
                <span>Automatic references with page numbers</span>
              </div>
            </li>
            <li>
              <div class="feature-icon">üåç</div>
              <div class="feature-content">
                <strong>Multilingual FR/EN</strong>
                <span>Automatic detection and localized responses</span>
              </div>
            </li>
            <li>
              <div class="feature-icon">‚úÖ</div>
              <div class="feature-content">
                <strong>Zero Hallucination</strong>
                <span>Strict input/output validation</span>
              </div>
            </li>
            <li>
              <div class="feature-icon">üîß</div>
              <div class="feature-content">
                <strong>Production-Ready</strong>
                <span>137 tests, CI/CD, monitoring</span>
              </div>
            </li>
          </ul>
          <a href="/en/portfolio/neolens-support-agent" class="demo-link">
            View full project ‚Üí
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Projects Grid -->
  <section class="portfolio-projects">
    <div class="container">
      <h2 class="section-title">Projects</h2>
      <div class="projects-grid">
        <!-- Agent RAG Neolens - Featured -->
        <div class="project-wrapper featured-project">
          <PortfolioCard
            title="Neolens RAG Agent"
            client="Medical AI Assistant"
            description="RAG agent specialized in medical image analysis. Intelligent search in Neolens documentation, source citations."
            tags={["Python", "FastAPI", "LangGraph", "FAISS", "React"]}
            image="/portfolio/01-home-welcome.png"
            link="/en/portfolio/neolens-support-agent"
            category={["ai-agent"]}
            githubUrl="https://github.com/berangeregallais/neolens-support-agent"
            lang="en"
          />
        </div>

        {
          projects.map((project, index) => (
            <div
              class="project-wrapper"
              style={`animation-delay: ${index * 0.1}s`}
            >
              <PortfolioCard
                title={project.data.title}
                client={project.data.client}
                description={project.data.description}
                tags={project.data.technologies}
                image={project.data.image}
                link={project.data.demoUrl!}
                category={project.data.category}
                githubUrl={project.data.githubUrl}
                lang="en"
              />
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- CTA Section -->
<section class="portfolio-cta">
  <div class="container">
    <div class="cta-content">
      <h2>Ready to create your AI agent?</h2>
      <p>
        Let's discuss your project and find the solution that fits your needs. 
        RAG agent, conversational, or custom - I'll guide you from A to Z.
      </p>
      <div class="cta-benefits">
        <div class="benefit">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M20 6 9 17l-5-5"></path>
          </svg>
          Custom AI Agent
        </div>
        <div class="benefit">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M20 6 9 17l-5-5"></path>
          </svg>
          Code + Documentation + Tests
        </div>
        <div class="benefit">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M20 6 9 17l-5-5"></path>
          </svg>
          Complete solution included
        </div>
      </div>
      <div class="cta-buttons">
        <a href="/en/contact" class="btn btn-primary btn-large">
          <span>Let's discuss your project</span>
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M5 12h14m-7-7 7 7-7 7"></path>
          </svg>
        </a>
        <a href="/en/offers" class="btn btn-secondary">View my offers</a>
      </div>
    </div>
  </div>
</section>
</BaseLayout>

<style>
  /* ===============================
   PORTFOLIO HERO
   =============================== */
  .portfolio-hero {
    padding: 8rem 0 5rem;
    background: linear-gradient(
      135deg,
      rgb(var(--color-background)) 0%,
      rgb(var(--color-primary) / 0.05) 50%,
      rgb(var(--color-accent) / 0.03) 100%
    );
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .portfolio-hero::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
      ellipse at center top,
      rgb(var(--color-primary) / 0.05) 0%,
      transparent 70%
    );
    pointer-events: none;
  }

  .hero-content {
    position: relative;
    z-index: 1;
    max-width: 900px;
    margin: 0 auto;
  }

  .portfolio-hero h1 {
    font-family: var(--font-serif);
    font-size: clamp(3rem, 6vw, 5rem);
    font-weight: 700;
    margin-bottom: 2rem;
    color: rgb(var(--color-text));
    letter-spacing: -0.02em;
  }

  .hero-subtitle {
    font-size: 1.375rem;
    color: rgb(var(--color-text-muted));
    margin: 0 auto 4rem;
    line-height: 1.7;
    font-weight: 400;
    max-width: 800px;
  }

  /* ===============================
   FEATURED DEMO SECTION
   =============================== */
  .featured-demo {
    padding: 6rem 0;
    background: linear-gradient(
      135deg,
      rgb(var(--color-primary) / 0.05) 0%,
      rgb(var(--color-accent) / 0.03) 100%
    );
  }

  .demo-header {
    text-align: center;
    max-width: 800px;
    margin: 0 auto 4rem;
  }

  .demo-badge {
    display: inline-block;
    background: linear-gradient(
      135deg,
      rgb(var(--color-primary)),
      rgb(var(--color-primary-hover))
    );
    color: rgb(var(--color-text-button));
    padding: 0.5rem 1.25rem;
    border-radius: 2rem;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    box-shadow: 0 4px 12px rgba(var(--color-primary), 0.2);
  }

  .demo-header h2 {
    font-family: var(--font-serif);
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: 700;
    margin-bottom: 1rem;
    color: rgb(var(--color-text));
  }

  .demo-header p {
    font-size: 1.125rem;
    color: rgb(var(--color-text-muted));
    line-height: 1.7;
  }

  .demo-grid {
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 3rem;
    align-items: start;
  }

  .demo-video {
    background: rgba(var(--color-surface-variant), 0.3);
    border: 1px solid rgba(var(--color-border), 0.3);
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-xl);
  }

  .demo-video video {
    width: 100%;
    height: auto;
    display: block;
    background: #000;
  }

  .demo-features {
    background: rgb(var(--color-surface));
    border: 1px solid rgba(var(--color-border), 0.3);
    border-radius: var(--radius-lg);
    padding: 2rem;
    box-shadow: var(--shadow-lg);
  }

  .demo-features h3 {
    font-size: 1.5rem;
    color: rgb(var(--color-text));
    margin-bottom: 1.5rem;
    font-weight: 700;
  }

  .demo-features ul {
    list-style: none;
    padding: 0;
    margin: 0 0 2rem 0;
  }

  .demo-features li {
    display: flex;
    gap: 1rem;
    padding: 1rem 0;
    border-bottom: 1px solid rgba(var(--color-border), 0.2);
  }

  .demo-features li:last-child {
    border-bottom: none;
  }

  .feature-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
  }

  .feature-content {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .feature-content strong {
    color: rgb(var(--color-text));
    font-size: 1rem;
    font-weight: 600;
  }

  .feature-content span {
    color: rgb(var(--color-text-muted));
    font-size: 0.875rem;
    line-height: 1.5;
  }

  .demo-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    background: linear-gradient(
      135deg,
      rgb(var(--color-primary)),
      rgb(var(--color-primary-hover))
    );
    color: rgb(var(--color-text-button));
    text-decoration: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    transition: all 0.2s ease;
    box-shadow: 0 4px 12px rgba(var(--color-primary), 0.2);
  }

  .demo-link:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(var(--color-primary), 0.3);
  }

  @media (max-width: 1024px) {
    .demo-grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }
  }

  /* ===============================
   PROJECTS SECTION
   =============================== */
  .portfolio-projects {
    padding: 8rem 0;
    background: rgb(var(--color-background));
  }

  .section-title {
    font-family: var(--font-serif);
    font-size: 3rem;
    text-align: center;
    margin-bottom: 4rem;
    color: rgb(var(--color-text));
    position: relative;
  }

  .section-title::after {
    content: "";
    position: absolute;
    bottom: -1rem;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 3px;
    background: linear-gradient(
      90deg,
      rgb(var(--color-primary)),
      rgb(var(--color-accent))
    );
    border-radius: 2px;
  }

  .projects-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 3rem;
  }

  .project-wrapper {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.8s ease-out forwards;
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* ===============================
   CTA SECTION
   =============================== */
  .portfolio-cta {
    padding: 8rem 0;
    background: linear-gradient(
      135deg,
      rgb(var(--color-primary) / 0.08) 0%,
      rgb(var(--color-accent) / 0.05) 100%
    );
    text-align: center;
    position: relative;
  }

  .portfolio-cta::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
      ellipse at center,
      rgb(var(--color-primary) / 0.03) 0%,
      transparent 70%
    );
  }

  .cta-content {
    position: relative;
    z-index: 1;
    max-width: 800px;
    margin: 0 auto;
  }

  .portfolio-cta h2 {
    font-family: var(--font-serif);
    font-size: 3rem;
    margin-bottom: 1.5rem;
    color: rgb(var(--color-text));
  }

  .portfolio-cta p {
    font-size: 1.25rem;
    color: rgb(var(--color-text-muted));
    margin-bottom: 3rem;
    line-height: 1.7;
  }

  .cta-benefits {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 3rem;
    flex-wrap: wrap;
  }

  .benefit {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    color: rgb(var(--color-text-muted));
  }

  .benefit svg {
    color: rgb(var(--color-primary));
  }

  .cta-buttons {
    display: flex;
    gap: 2rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  /* ===============================
   BUTTONS
   =============================== */
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 2rem;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    transition: all var(--transition-normal);
    border: 2px solid transparent;
  }

  :root[data-theme="light"] .btn-primary {
    color: #d0d0d0;
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 24px rgb(var(--color-primary) / 0.3);
  }

  .btn-secondary {
    background: transparent;
    color: rgb(var(--color-text));
    border-color: rgb(var(--color-border));
  }

  .btn-secondary:hover {
    background: rgb(var(--color-surface));
    transform: translateY(-2px);
  }

  .btn-large {
    padding: 1.25rem 2.5rem;
    font-size: 1.1rem;
  }

  /* ===============================
   RESPONSIVE
   =============================== */
  @media (max-width: 768px) {
    .portfolio-hero {
      padding: 6rem 0 4rem;
    }

    .hero-subtitle {
      font-size: 1.125rem;
    }

    .portfolio-stats {
      gap: 2.5rem;
      flex-wrap: wrap;
    }

    .projects-grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .cta-benefits {
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .cta-buttons {
      flex-direction: column;
      align-items: center;
    }

    .section-title,
    .portfolio-cta h2 {
      font-size: 2.25rem;
    }
  }

  @media (max-width: 480px) {
    .projects-grid {
      grid-template-columns: 1fr;
    }
  }

  /* ===============================
   Portfolio Page Adjustments
   =============================== */

  /* R√©duction des espacements entre sections */
  .portfolio-hero {
    padding: 4rem 0 3rem; 
  }
  .portfolio-projects {
    padding: 4rem 0; 
  }
  .portfolio-cta {
    padding: 4rem 0;
  }

  /* Ajustement du titre/intro */
  .portfolio-hero .hero-subtitle {
    margin-top: 0.75rem;
    margin-bottom: 0; 
  }

  /* Emp√™che les boutons CTA de s‚Äô√©tirer en largeur sur mobile */
  @media (max-width: 768px) {
    .cta-buttons .btn {
      display: inline-flex !important;
      width: auto !important;
      max-width: 100%;
      flex: 0 0 auto; 
      align-self: center; 
    }

    .cta-buttons {
      flex-direction: column; 
      align-items: center;
      gap: 1rem;
    }
  }
</style>
